use kafka_protocol::messages::*;
use std::fmt::Debug;

#[derive(Clone, Copy, Debug, PartialEq)]
pub struct ProtoInfo {
    pub(crate) correlation_id: i32,
    pub(crate) header_version: i16,
    pub(crate) api_version: i16,
}

#[derive(Debug, Clone, PartialEq)]
pub enum KafkaResponse {
    ProduceResponse(ProduceResponse),
    FetchResponse(FetchResponse),
    ListOffsetsResponse(ListOffsetsResponse),
    MetadataResponse(MetadataResponse),
    LeaderAndIsrResponse(LeaderAndIsrResponse),
    StopReplicaResponse(StopReplicaResponse),
    UpdateMetadataResponse(UpdateMetadataResponse),
    ControlledShutdownResponse(ControlledShutdownResponse),
    OffsetCommitResponse(OffsetCommitResponse),
    OffsetFetchResponse(OffsetFetchResponse),
    FindCoordinatorResponse(FindCoordinatorResponse),
    JoinGroupResponse(JoinGroupResponse),
    HeartbeatResponse(HeartbeatResponse),
    LeaveGroupResponse(LeaveGroupResponse),
    SyncGroupResponse(SyncGroupResponse),
    DescribeGroupsResponse(DescribeGroupsResponse),
    ListGroupsResponse(ListGroupsResponse),
    SaslHandshakeResponse(SaslHandshakeResponse),
    ApiVersionsResponse(ApiVersionsResponse),
    CreateTopicsResponse(CreateTopicsResponse),
    DeleteTopicsResponse(DeleteTopicsResponse),
    DeleteRecordsResponse(DeleteRecordsResponse),
    InitProducerIdResponse(InitProducerIdResponse),
    OffsetForLeaderEpochResponse(OffsetForLeaderEpochResponse),
    AddPartitionsToTxnResponse(AddPartitionsToTxnResponse),
    AddOffsetsToTxnResponse(AddOffsetsToTxnResponse),
    EndTxnResponse(EndTxnResponse),
    WriteTxnMarkersResponse(WriteTxnMarkersResponse),
    TxnOffsetCommitResponse(TxnOffsetCommitResponse),
    DescribeAclsResponse(DescribeAclsResponse),
    CreateAclsResponse(CreateAclsResponse),
    DeleteAclsResponse(DeleteAclsResponse),
    DescribeConfigsResponse(DescribeConfigsResponse),
    AlterConfigsResponse(AlterConfigsResponse),
    AlterReplicaLogDirsResponse(AlterReplicaLogDirsResponse),
    DescribeLogDirsResponse(DescribeLogDirsResponse),
    SaslAuthenticateResponse(SaslAuthenticateResponse),
    CreatePartitionsResponse(CreatePartitionsResponse),
    CreateDelegationTokenResponse(CreateDelegationTokenResponse),
    RenewDelegationTokenResponse(RenewDelegationTokenResponse),
    ExpireDelegationTokenResponse(ExpireDelegationTokenResponse),
    DescribeDelegationTokenResponse(DescribeDelegationTokenResponse),
    DeleteGroupsResponse(DeleteGroupsResponse),
    ElectLeadersResponse(ElectLeadersResponse),
    IncrementalAlterConfigsResponse(IncrementalAlterConfigsResponse),
    AlterPartitionReassignmentsResponse(AlterPartitionReassignmentsResponse),
    ListPartitionReassignmentsResponse(ListPartitionReassignmentsResponse),
    OffsetDeleteResponse(OffsetDeleteResponse),
    DescribeClientQuotasResponse(DescribeClientQuotasResponse),
    AlterClientQuotasResponse(AlterClientQuotasResponse),
    DescribeUserScramCredentialsResponse(DescribeUserScramCredentialsResponse),
    AlterUserScramCredentialsResponse(AlterUserScramCredentialsResponse),
    VoteResponse(VoteResponse),
    BeginQuorumEpochResponse(BeginQuorumEpochResponse),
    EndQuorumEpochResponse(EndQuorumEpochResponse),
    DescribeQuorumResponse(DescribeQuorumResponse),
    AlterPartitionResponse(AlterPartitionResponse),
    UpdateFeaturesResponse(UpdateFeaturesResponse),
    EnvelopeResponse(EnvelopeResponse),
    FetchSnapshotResponse(FetchSnapshotResponse),
    DescribeClusterResponse(DescribeClusterResponse),
    DescribeProducersResponse(DescribeProducersResponse),
    BrokerRegistrationResponse(BrokerRegistrationResponse),
    BrokerHeartbeatResponse(BrokerHeartbeatResponse),
    UnregisterBrokerResponse(UnregisterBrokerResponse),
    DescribeTransactionsResponse(DescribeTransactionsResponse),
    ListTransactionsResponse(ListTransactionsResponse),
    AllocateProducerIdsResponse(AllocateProducerIdsResponse),
    ConsumerGroupHeartbeatResponse(ConsumerGroupHeartbeatResponse),
    ConsumerGroupDescribeResponse(ConsumerGroupDescribeResponse),
    ControllerRegistrationResponse(ControllerRegistrationResponse),
    GetTelemetrySubscriptionsResponse(GetTelemetrySubscriptionsResponse),
    PushTelemetryResponse(PushTelemetryResponse),
    AssignReplicasToDirsResponse(AssignReplicasToDirsResponse),
    ListClientMetricsResourcesResponse(ListClientMetricsResourcesResponse),
    DescribeTopicPartitionsResponse(DescribeTopicPartitionsResponse),
}

impl KafkaResponse {
    pub fn api_key(&self) -> ApiKey {
        match self {
            KafkaResponse::ProduceResponse(_) => ApiKey::Produce,
            KafkaResponse::FetchResponse(_) => ApiKey::Fetch,
            KafkaResponse::ListOffsetsResponse(_) => ApiKey::ListOffsets,
            KafkaResponse::MetadataResponse(_) => ApiKey::Metadata,
            KafkaResponse::LeaderAndIsrResponse(_) => ApiKey::LeaderAndIsr,
            KafkaResponse::StopReplicaResponse(_) => ApiKey::StopReplica,
            KafkaResponse::UpdateMetadataResponse(_) => ApiKey::UpdateMetadata,
            KafkaResponse::ControlledShutdownResponse(_) => ApiKey::ControlledShutdown,
            KafkaResponse::OffsetCommitResponse(_) => ApiKey::OffsetCommit,
            KafkaResponse::OffsetFetchResponse(_) => ApiKey::OffsetFetch,
            KafkaResponse::FindCoordinatorResponse(_) => ApiKey::FindCoordinator,
            KafkaResponse::JoinGroupResponse(_) => ApiKey::JoinGroup,
            KafkaResponse::HeartbeatResponse(_) => ApiKey::Heartbeat,
            KafkaResponse::LeaveGroupResponse(_) => ApiKey::LeaveGroup,
            KafkaResponse::SyncGroupResponse(_) => ApiKey::SyncGroup,
            KafkaResponse::DescribeGroupsResponse(_) => ApiKey::DescribeGroups,
            KafkaResponse::ListGroupsResponse(_) => ApiKey::ListGroups,
            KafkaResponse::SaslHandshakeResponse(_) => ApiKey::SaslHandshake,
            KafkaResponse::ApiVersionsResponse(_) => ApiKey::ApiVersions,
            KafkaResponse::CreateTopicsResponse(_) => ApiKey::CreateTopics,
            KafkaResponse::DeleteTopicsResponse(_) => ApiKey::DeleteTopics,
            KafkaResponse::DeleteRecordsResponse(_) => ApiKey::DeleteRecords,
            KafkaResponse::InitProducerIdResponse(_) => ApiKey::InitProducerId,
            KafkaResponse::OffsetForLeaderEpochResponse(_) => ApiKey::OffsetForLeaderEpoch,
            KafkaResponse::AddPartitionsToTxnResponse(_) => ApiKey::AddPartitionsToTxn,
            KafkaResponse::AddOffsetsToTxnResponse(_) => ApiKey::AddOffsetsToTxn,
            KafkaResponse::EndTxnResponse(_) => ApiKey::EndTxn,
            KafkaResponse::WriteTxnMarkersResponse(_) => ApiKey::WriteTxnMarkers,
            KafkaResponse::TxnOffsetCommitResponse(_) => ApiKey::TxnOffsetCommit,
            KafkaResponse::DescribeAclsResponse(_) => ApiKey::DescribeAcls,
            KafkaResponse::CreateAclsResponse(_) => ApiKey::CreateAcls,
            KafkaResponse::DeleteAclsResponse(_) => ApiKey::DeleteAcls,
            KafkaResponse::DescribeConfigsResponse(_) => ApiKey::DescribeConfigs,
            KafkaResponse::AlterConfigsResponse(_) => ApiKey::AlterConfigs,
            KafkaResponse::AlterReplicaLogDirsResponse(_) => ApiKey::AlterReplicaLogDirs,
            KafkaResponse::DescribeLogDirsResponse(_) => ApiKey::DescribeLogDirs,
            KafkaResponse::SaslAuthenticateResponse(_) => ApiKey::SaslAuthenticate,
            KafkaResponse::CreatePartitionsResponse(_) => ApiKey::CreatePartitions,
            KafkaResponse::CreateDelegationTokenResponse(_) => ApiKey::CreateDelegationToken,
            KafkaResponse::RenewDelegationTokenResponse(_) => ApiKey::RenewDelegationToken,
            KafkaResponse::ExpireDelegationTokenResponse(_) => ApiKey::ExpireDelegationToken,
            KafkaResponse::DescribeDelegationTokenResponse(_) => ApiKey::DescribeDelegationToken,
            KafkaResponse::DeleteGroupsResponse(_) => ApiKey::DescribeGroups,
            KafkaResponse::ElectLeadersResponse(_) => ApiKey::ElectLeaders,
            KafkaResponse::IncrementalAlterConfigsResponse(_) => ApiKey::IncrementalAlterConfigs,
            KafkaResponse::AlterPartitionReassignmentsResponse(_) => ApiKey::AlterPartitionReassignments,
            KafkaResponse::ListPartitionReassignmentsResponse(_) => ApiKey::ListPartitionReassignments,
            KafkaResponse::OffsetDeleteResponse(_) => ApiKey::OffsetDelete,
            KafkaResponse::DescribeClientQuotasResponse(_) => ApiKey::DescribeClientQuotas,
            KafkaResponse::AlterClientQuotasResponse(_) => ApiKey::AlterClientQuotas,
            KafkaResponse::DescribeUserScramCredentialsResponse(_) => ApiKey::DescribeUserScramCredentials,
            KafkaResponse::AlterUserScramCredentialsResponse(_) => ApiKey::AlterUserScramCredentials,
            KafkaResponse::VoteResponse(_) => ApiKey::Vote,
            KafkaResponse::BeginQuorumEpochResponse(_) => ApiKey::BeginQuorumEpoch,
            KafkaResponse::EndQuorumEpochResponse(_) => ApiKey::EndQuorumEpoch,
            KafkaResponse::DescribeQuorumResponse(_) => ApiKey::DescribeQuorum,
            KafkaResponse::AlterPartitionResponse(_) => ApiKey::AlterPartition,
            KafkaResponse::UpdateFeaturesResponse(_) => ApiKey::UpdateFeatures,
            KafkaResponse::EnvelopeResponse(_) => ApiKey::Envelope,
            KafkaResponse::FetchSnapshotResponse(_) => ApiKey::FetchSnapshot,
            KafkaResponse::DescribeClusterResponse(_) => ApiKey::DescribeCluster,
            KafkaResponse::DescribeProducersResponse(_) => ApiKey::DescribeProducers,
            KafkaResponse::BrokerRegistrationResponse(_) => ApiKey::BrokerRegistration,
            KafkaResponse::BrokerHeartbeatResponse(_) => ApiKey::BrokerHeartbeat,
            KafkaResponse::UnregisterBrokerResponse(_) => ApiKey::UnregisterBroker,
            KafkaResponse::DescribeTransactionsResponse(_) => ApiKey::DescribeTransactions,
            KafkaResponse::ListTransactionsResponse(_) => ApiKey::ListTransactions,
            KafkaResponse::AllocateProducerIdsResponse(_) => ApiKey::AllocateProducerIds,
            KafkaResponse::ConsumerGroupHeartbeatResponse(_) => ApiKey::ConsumerGroupHeartbeat,
            KafkaResponse::ConsumerGroupDescribeResponse(_) => ApiKey::ConsumerGroupDescribe,
            KafkaResponse::ControllerRegistrationResponse(_) => ApiKey::ControllerRegistration,
            KafkaResponse::GetTelemetrySubscriptionsResponse(_) => ApiKey::GetTelemetrySubscriptions,
            KafkaResponse::PushTelemetryResponse(_) => ApiKey::PushTelemetry,
            KafkaResponse::AssignReplicasToDirsResponse(_) => ApiKey::AssignReplicasToDirs,
            KafkaResponse::ListClientMetricsResourcesResponse(_) => ApiKey::ListClientMetricsResources,
            KafkaResponse::DescribeTopicPartitionsResponse(_) => ApiKey::DescribeTopicPartitions,
        }
    }
}
